# TSA雋ｩ螢ｲ邂｡逅・B繧ｷ繧ｹ繝・Β・・sai-sales-db・蛾幕逋ｺ繝峨く繝･繝｡繝ｳ繝・

## 1. 繝励Ο繧ｸ繧ｧ繧ｯ繝域ｦりｦ・
譛ｬ繝励Ο繧ｸ繧ｧ繧ｯ繝医・縲∝・縲・ercel荳翫〒繝悶Λ繧ｦ繧ｶ繝吶・繧ｹ縺ｧ髢狗匱縺輔ｌ縺ｦ縺・◆雋ｩ螢ｲ邂｡逅・・KPI蛻・梵繧ｷ繧ｹ繝・Β繧偵√Ο繝ｼ繧ｫ繝ｫ迺ｰ蠅・ｼ・C:\Users\ts\OneDrive\Desktop\菴懈･ｭ逕ｨ\tsai-sales-db`・峨〒髢狗匱繝ｻ驕狗畑縺ｧ縺阪ｋ繧医≧縺ｫ迺ｰ蠅・ｧ狗ｯ峨ｒ陦後▲縺溘ｂ縺ｮ縺ｧ縺吶・
DB縺ｯSupabase縲、I蛻・梵縺ｫ縺ｯGoogle Gemini API縲∬ｪ崎ｨｼ縺ｫ縺ｯNextAuth.js・・oogle隱崎ｨｼ・峨ｒ菴ｿ逕ｨ縺励※縺・∪縺吶・

## 2. 繝ｭ繝ｼ繧ｫ繝ｫ迺ｰ蠅・ｧ狗ｯ牙ｱ･豁ｴ・・026/02/02螳滓命・・

### 2.1. 蜑肴署迺ｰ蠅・
*   OS: Windows
*   Node.js迺ｰ蠅・ `npm` 菴ｿ逕ｨ
*   菴懈･ｭ繝・ぅ繝ｬ繧ｯ繝医Μ: `C:\Users\ts\OneDrive\Desktop\菴懈･ｭ逕ｨ\tsai-sales-db`

### 2.2. 萓晏ｭ倬未菫ゅ・繧､繝ｳ繧ｹ繝医・繝ｫ
繝励Ο繧ｸ繧ｧ繧ｯ繝医↓縺ｯ萓晏ｭ倬未菫ゅ・荳肴紛蜷医′縺ゅ▲縺溘◆繧√∽ｻ･荳九・繧ｳ繝槭Φ繝峨〒繧､繝ｳ繧ｹ繝医・繝ｫ繧貞ｮ滓命縺励∪縺励◆縲・
```bash
npm install --legacy-peer-deps
```

### 2.3. 繝昴・繝育分蜿ｷ縺ｮ螟画峩・磯㍾隕・ｼ・
蜷御ｸ繝槭す繝ｳ蜀・〒遞ｼ蜒肴ｭ､縺ｦ縺・ｋ蛻･縺ｮ繝√Ε繝・ヨ繝懊ャ繝医す繧ｹ繝・Β・・shopee-chatbot`・峨′繝昴・繝・`3000` 繧剃ｽｿ逕ｨ縺励※縺・◆縺溘ａ縲∵悽繧ｷ繧ｹ繝・Β縺ｯ繝昴・繝・**`3001`** 繧剃ｽｿ逕ｨ縺吶ｋ繧医≧縺ｫ險ｭ螳壹ｒ螟画峩縺励∪縺励◆縲・

**螟画峩轤ｹ:**
1.  **`package.json`**: `scripts` 縺ｮ `dev` 繧ｳ繝槭Φ繝峨ｒ菫ｮ豁｣
    ```json
    "scripts": {
      "dev": "next dev -p 3001",
      // ...
    }
    ```
2.  **`.vscode/launch.json`**: 繝・ヰ繝・げ襍ｷ蜍墓凾縺ｮURL繧・`http://localhost:3001` 縺ｫ險ｭ螳・

### 2.4. 迺ｰ蠅・､画焚縺ｮ險ｭ螳・(`.env.local`)
繝ｭ繝ｼ繧ｫ繝ｫ髢狗匱逕ｨ縺ｫ `.env.local` 繝輔ぃ繧､繝ｫ繧剃ｽ懈・縺励∽ｻ･荳九・螟画焚繧定ｨｭ螳壹＠縺ｾ縺励◆縲・
窶ｻ繧ｻ繧ｭ繝･繝ｪ繝・ぅ縺ｮ縺溘ａ縲∝ｮ滄圀縺ｮ蛟､縺ｯ險倩ｼ峨＠縺ｦ縺・∪縺帙ｓ縲る幕逋ｺ譎ゅ・ `.env.local` 繧貞盾辣ｧ縺ｮ縺薙→縲・

| 螟画焚蜷・| 隱ｬ譏・| 蜿門ｾ怜ｴ謇 |
| :--- | :--- | :--- |
| `DATABASE_URL` | Supabase DB謗･邯壽枚蟄怜・ | Vercel Project Settings / Supabase Settings |
| `NEXT_PUBLIC_SUPABASE_URL` | Supabase URL | Supabase Dashboard |
| `NEXT_PUBLIC_SUPABASE_ANON_KEY` | Supabase Anon Key | Supabase Dashboard |
| `SUPABASE_SERVICE_ROLE_KEY` | Supabase Service Role Key | Supabase Dashboard (Security豕ｨ諢・ |
| `OPENAI_API_KEY` | OpenAI API繧ｭ繝ｼ | (譛ｬ繝励Ο繧ｸ繧ｧ繧ｯ繝医〒縺ｯGemini繝｡繧､繝ｳ縺縺瑚ｨｭ螳壽怏) |
| `GEMINI_API_KEY` | Google Gemini API繧ｭ繝ｼ | Google AI Studio / Vercel |
| **`SUPABASE_JWT_SECRET`** | JWT鄂ｲ蜷咲畑繧ｷ繝ｼ繧ｯ繝ｬ繝・ヨ | Supabase > Project Settings > API > **Legacy JWT Secret** 縺ｾ縺溘・ Custom Secret |
| **`GOOGLE_CLIENT_ID`** | Google OAuth Client ID | Google Cloud Console > APIs & Services > Credentials |
| **`GOOGLE_CLIENT_SECRET`** | Google OAuth Client Secret | 蜷御ｸ・|
| **`NEXTAUTH_URL`** | 隱崎ｨｼ蠕後・繝ｪ繝繧､繝ｬ繧ｯ繝亥・URL | **`http://localhost:3001`** (繝昴・繝・001繧呈欠螳・ |
| `NEXTAUTH_SECRET` | NextAuth逕ｨ繧ｷ繝ｼ繧ｯ繝ｬ繝・ヨ | 莉ｻ諢上・譁・ｭ怜・ |

### 2.5. Google OAuth隱崎ｨｼ縺ｮ險ｭ螳夲ｼ・oogle Cloud Console・・
繝ｭ繝ｼ繧ｫ繝ｫ迺ｰ蠅・ｼ医・繝ｼ繝・001・峨〒縺ｮGoogle繝ｭ繧ｰ繧､繝ｳ繧呈怏蜉ｹ縺ｫ縺吶ｋ縺溘ａ縲∽ｻ･荳九・險ｭ螳壹ｒ陦後＞縺ｾ縺励◆縲・

1.  **Google Cloud Console** 縺ｫ繧｢繧ｯ繧ｻ繧ｹ (`https://console.cloud.google.com/apis/credentials`)
2.  縲窟PI縺ｨ繧ｵ繝ｼ繝薙せ縲・> 縲瑚ｪ崎ｨｼ諠・ｱ縲・> 縲薫Auth 2.0 繧ｯ繝ｩ繧､繧｢繝ｳ繝・ID縲・> 蟇ｾ雎｡繧｢繝励Μ・・SA隱崎ｨｼ繧ｷ繧ｹ繝・Β・峨ｒ驕ｸ謚・
3.  **縲梧価隱肴ｸ医∩縺ｮ繝ｪ繝繧､繝ｬ繧ｯ繝・URI縲・* 縺ｫ莉･荳九ｒ霑ｽ蜉縺励※菫晏ｭ・
    *   `http://localhost:3001/api/auth/callback/google`

縺薙ｌ繧定｡後ｏ縺ｪ縺・→縲√Ο繧ｰ繧､繝ｳ譎ゅ↓ `Error 400: redirect_uri_mismatch` 縺檎匱逕溘＠縺ｾ縺吶・

### 2.6. Next.js 15 (v16邉ｻ) API繝ｫ繝ｼ繝亥ｯｾ蠢懶ｼ・026/02/03霑ｽ險假ｼ・
Next.js 15 (v16邉ｻ) 縺ｮ莉墓ｧ伜､画峩縺ｫ繧医ｊ縲、PI繝ｫ繝ｼ繝茨ｼ・pp Router・峨・ `params` 縺碁撼蜷梧悄・・romise・峨↓螟画峩縺輔ｌ縺ｾ縺励◆縲・
蜍慕噪繝ｫ繝ｼ繝茨ｼ・app/api/links/[id]/route.ts` 遲会ｼ峨〒 `params` 繧・`await` 縺帙★縺ｫ菴ｿ逕ｨ縺吶ｋ縺ｨ `invalid input syntax for type uuid: "undefined"` 繧ｨ繝ｩ繝ｼ縺檎匱逕溘☆繧九◆繧√∽ｻ･荳九・菫ｮ豁｣繧定｡後＞縺ｾ縺励◆縲・

**菫ｮ豁｣蜀・ｮｹ:**
*   `PUT` 縺翫ｈ縺ｳ `DELETE` 繝｡繧ｽ繝・ラ縺ｮ蠑墓焚螳夂ｾｩ繧貞､画峩縺励～params` 繧・`await` 縺励※蜿門ｾ励☆繧九ｈ縺・↓菫ｮ豁｣縲・

```typescript
// 菫ｮ豁｣蜑・
export async function PUT(request: NextRequest, { params }: { params: { id: string } }) { ... }

// 菫ｮ豁｣蠕・
export async function PUT(request: NextRequest, props: { params: Promise<{ id: string }> }) {
  const params = await props.params;
  const { id } = params;
  // ...
}
```

## 3. 繧｢繝励Μ繧ｱ繝ｼ繧ｷ繝ｧ繝ｳ縺ｮ襍ｷ蜍墓婿豕・
莉･荳九・繧ｳ繝槭Φ繝峨〒髢狗匱繧ｵ繝ｼ繝舌・繧定ｵｷ蜍輔＠縺ｾ縺吶・
```bash
npm run dev
```
襍ｷ蜍募ｾ後√ヶ繝ｩ繧ｦ繧ｶ縺ｧ `http://localhost:3001` 縺ｫ繧｢繧ｯ繧ｻ繧ｹ縺励∪縺吶・

## 4. 迚ｹ險倅ｺ矩・・豕ｨ諢冗せ
*   **繝・・繧ｿ蜷梧悄**: 繝ｭ繝ｼ繧ｫ繝ｫ迺ｰ蠅・・ `.env.local` 縺ｯ譛ｬ逡ｪ迺ｰ蠅・→蜷後§Supabase繝励Ο繧ｸ繧ｧ繧ｯ繝医ｒ蜿ら・縺励※縺・∪縺吶ゅ◎縺ｮ縺溘ａ縲・*繝ｭ繝ｼ繧ｫ繝ｫ縺ｧ縺ｮ繝・・繧ｿ謫堺ｽ懶ｼ・RUD・峨・蜊ｳ蠎ｧ縺ｫ譛ｬ逡ｪ繝・・繧ｿ繝吶・繧ｹ縺ｫ蜿肴丐縺輔ｌ縺ｾ縺・*縲ゅユ繧ｹ繝医ョ繝ｼ繧ｿ縺ｮ謚募・繧・炎髯､縺ｫ縺ｯ蜊∝・豕ｨ諢上＠縺ｦ縺上□縺輔＞縲・
*   **VS Code險ｭ螳・*: `.vscode` 繝輔か繝ｫ繝蜀・↓謗ｨ螂ｨ諡｡蠑ｵ讖溯・ (`extensions.json`) 縺ｨ繝・ヰ繝・げ險ｭ螳・(`launch.json`) 繧定ｿｽ蜉縺励∪縺励◆縲７S Code縺ｧ縺ｮ髢狗匱繧呈耳螂ｨ縺励∪縺吶・

## 5. 閾ｪ遉ｾ繝ｪ繝ｳ繧ｯ髮・- 逕ｻ蜒上い繝・・繝ｭ繝ｼ繝画ｩ溯・・・026/02/03霑ｽ蜉・・

### 5.1. 讖溯・讎りｦ・
閾ｪ遉ｾ繝ｪ繝ｳ繧ｯ髮・ｼ・/links`・峨↓OGP逕ｻ蜒上・繧｢繝・・繝ｭ繝ｼ繝画ｩ溯・繧定ｿｽ蜉縺励∪縺励◆縲ゅ％繧後↓繧医ｊ縲＾GP閾ｪ蜍募叙蠕励′菴ｿ縺医↑縺・Ο繝ｼ繧ｫ繝ｫ繧ｵ繧､繝茨ｼ・hopee繝懊ャ繝育ｭ会ｼ峨↓蟇ｾ縺励※繧ゅ∵焔蜍輔〒逕ｻ蜒上ｒ險ｭ螳壹〒縺阪ｋ繧医≧縺ｫ縺ｪ繧翫∪縺励◆縲・

### 5.2. 螳溯｣・・螳ｹ
*   **繝輔Ο繝ｳ繝医お繝ｳ繝・* (`app/links/page.tsx`): 
    *   OGP逕ｻ蜒乗ｬ・↓縲後い繝・・繝ｭ繝ｼ繝峨阪・繧ｿ繝ｳ繧定ｿｽ蜉
    *   繝輔ぃ繧､繝ｫ驕ｸ謚槫ｾ後∬・蜍輔〒Supabase Storage縺ｸ繧｢繝・・繝ｭ繝ｼ繝・
    *   5MB莉･荳九・逕ｻ蜒上ヵ繧｡繧､繝ｫ縺ｮ縺ｿ蟇ｾ蠢・
*   **繝舌ャ繧ｯ繧ｨ繝ｳ繝・* (`app/api/links/upload-image/route.ts`): 
    *   逕ｻ蜒上ｒ蜿励￠蜿悶ｊSupabase Storage縺ｫ菫晏ｭ・
    *   蜈ｬ髢偽RL繧定ｿ泌唆

### 5.3. Supabase Storage險ｭ螳・
逕ｻ蜒上い繝・・繝ｭ繝ｼ繝峨↓縺ｯSupabase Storage縺ｮ繝舌こ繝・ヨ縺悟ｿ・ｦ√〒縺吶・
*   **繝舌こ繝・ヨ蜷・*: `link-images`
*   **繧｢繧ｯ繧ｻ繧ｹ**: Public・亥・髢具ｼ・
*   **險ｭ螳壼ｴ謇**: Supabase Dashboard > Storage > New bucket

## 6. 蜈ｨ遉ｾ螢ｲ荳階PI繝繝・す繝･繝懊・繝画ｩ溯・・・026/02/05霑ｽ蜉・・

### 6.1. 讖溯・讎りｦ・
蜈ｨ繝√Ε繝阪Ν・・eb縲∝査縲√ヶ繝ｩ繝ｳ繝蛾､ｨ縲・｣溘・繝悶Λ繝ｳ繝蛾､ｨ・峨・螢ｲ荳翫ｒ邨ｱ蜷医＠縲∫岼讓吝ｯｾ豈費ｼ磯＃謌千紫・峨∝燕蟷ｴ豈皮ｭ峨ｒ荳蜈・ｮ｡逅・☆繧九ム繝・す繝･繝懊・繝峨ｒ螳溯｣・＠縺ｾ縺励◆縲・

### 6.2. 謚陦鍋噪謾ｹ蝟・せ繝ｻ菫ｮ豁｣
髢狗匱驕守ｨ九〒逋ｺ逕溘＠縺溯ｪｲ鬘後↓蟇ｾ縺励∽ｻ･荳九・謚陦鍋噪蟇ｾ蠢懊ｒ陦後＞縺ｾ縺励◆縲・

1.  **髮・ｨ亥・逅・・譛驕ｩ蛹厄ｼ・PC蛹厄ｼ・*
    *   **隱ｲ鬘・*: 蜈ｨ莉ｶ繝・・繧ｿ繧偵け繝ｩ繧､繧｢繝ｳ繝亥・縺ｧ蜿門ｾ励・險育ｮ励☆繧九→縲√ち繧､繝繧｢繧ｦ繝医ｄ陦梧焚蛻ｶ髯撰ｼ・000莉ｶ・峨↓謚ｵ隗ｦ縺吶ｋ諱舌ｌ縺後≠縺｣縺溘・
    *   **蟇ｾ蠢・*: 隍・尅縺ｪ髮・ｨ医け繧ｨ繝ｪ・亥ｺ苓・蛻･縲∵怦蛻･髮・ｨ茨ｼ峨ｒSupabase蛛ｴ縺ｮ**Database Functions (RPC)** 縺ｫ遘ｻ陦後・PI縺九ｉ縺ｯ `get_web_sales_monthly` 遲峨・髢｢謨ｰ繧貞他縺ｳ蜃ｺ縺吶□縺代・霆ｽ驥上↑讒区・縺ｫ螟画峩縲・

2.  **繧ｻ繧ｭ繝･繝ｪ繝・ぅ縺ｨ讓ｩ髯占ｨｭ螳・(SECURITY DEFINER)**
    *   **隱ｲ鬘・*: 謇句虚蜈･蜉帷岼讓吝､繝・・繝悶Ν (`kpi_manual_entries_v1`) 遲峨∈縺ｮ繧｢繧ｯ繧ｻ繧ｹ譎ゅ∵ｨｩ髯蝉ｸ崎ｶｳ縺ｫ繧医ｋ `406 Not Acceptable` 繧ｨ繝ｩ繝ｼ縺檎匱逕溘・
    *   **蟇ｾ蠢・*: RPC髢｢謨ｰ縺ｫ `SECURITY DEFINER` 繧ｪ繝励す繝ｧ繝ｳ繧剃ｻ倅ｸ弱＠縲・未謨ｰ縺ｮ螳溯｡瑚・′繝・・繝悶Ν縺ｮ繧｢繧ｯ繧ｻ繧ｹ讓ｩ髯舌ｒ謖√▲縺ｦ縺・↑縺上※繧ゑｼ・PI邨檎罰縺ｧ縺ゅｌ縺ｰ・牙ｮ牙・縺ｫ繝・・繧ｿ蜿門ｾ励〒縺阪ｋ繧医≧縺ｫ菫ｮ豁｣縲・

3.  **API隱崎ｨｼ縺ｮ邨ｱ荳・・SV繧､繝ｳ繝昴・繝域ｩ溯・菫ｮ豁｣・・*
    *   **隱ｲ鬘・*: 鬟溘・繝悶Λ繝ｳ繝蛾､ｨCSV繧､繝ｳ繝昴・繝域ｩ溯・縺ｧ `Auth session missing` 繧ｨ繝ｩ繝ｼ縺檎匱逕溘・extAuth・・oogle繝ｭ繧ｰ繧､繝ｳ・峨・繧ｻ繝・す繝ｧ繝ｳ縺ｨSupabase Auth縺ｮ繧ｻ繝・す繝ｧ繝ｳ縺ｮ荳肴紛蜷医′蜴溷屏縲・
### 6.2. 謚陦鍋噪謾ｹ蝟・せ繝ｻ菫ｮ豁｣
    *   **蟇ｾ蠢・*: API繝ｫ繝ｼ繝・(`/api/food-store/import`) 縺ｮ隱崎ｨｼ繝ｭ繧ｸ繝・け繧剃ｿｮ豁｣縲４upabase縺ｮ繧ｻ繝・す繝ｧ繝ｳ遒ｺ隱阪ｒ蟒・ｭ｢縺励・*NextAuth縺ｮ繝医・繧ｯ繝ｳ (`getToken`) 繧呈､懆ｨｼ**縺吶ｋ譁ｹ蠑上↓螟画峩縲・B謫堺ｽ懊↓縺ｯ邂｡逅・・ｨｩ髯撰ｼ・ervice Role・峨ｒ菴ｿ逕ｨ縺吶ｋ縺薙→縺ｧ縲∬ｪ崎ｨｼ縺ｨDB謫堺ｽ懊ｒ蛻・屬縺励∵ｭ｣蟶ｸ縺ｫ蜍穂ｽ懊☆繧九ｈ縺・↓菫ｮ豁｣縲・

## 7. KPI繝繝・す繝･繝懊・繝画ｩ溯・蠑ｷ蛹厄ｼ・026/02/07霑ｽ蜉・・

### 7.1. 繧､繝ｳ繝ｩ繧､繝ｳ邱ｨ髮・ｩ溯・・・nline Editing・・
KPI繝繝・す繝･繝懊・繝我ｸ翫・謨ｰ蛟､・育岼讓吶・螳溽ｸｾ・峨ｒ縲・xcel縺ｮ繧医≧縺ｫ繧ｻ繝ｫ繧堤峩謗･繧ｯ繝ｪ繝・け縺励※邱ｨ髮・・菫晏ｭ倥〒縺阪ｋ讖溯・繧貞ｮ溯｣・＠縺ｾ縺励◆縲・
*   **蟇ｾ雎｡**: 
    *   驛ｨ髢蛻･螢ｲ荳奇ｼ育岼讓吶・螳溽ｸｾ・・
    *   蝟ｶ讌ｭ豢ｻ蜍募ｮ溽ｸｾ・域眠隕上・OEM迯ｲ蠕礼岼讓吶・螳溽ｸｾ・・
    *   蝠・刀陬ｽ騾謨ｰ・育岼讓吶・螳溽ｸｾ・・
*   **謫堺ｽ・*: 繧ｻ繝ｫ繧偵け繝ｪ繝・け -> 謨ｰ蛟､蜈･蜉・-> Enter縺ｾ縺溘・繝輔か繝ｼ繧ｫ繧ｹ繧｢繧ｦ繝医〒蜊ｳ譎ゆｿ晏ｭ假ｼ医し繝ｼ繝舌・繧｢繧ｯ繧ｷ繝ｧ繝ｳ邨檎罰縺ｧDB譖ｴ譁ｰ・・く繝｣繝・す繝･蜀肴､懆ｨｼ・峨・

### 7.2. 繝・・繧ｿ閾ｪ蜍募渚譏繝ｭ繧ｸ繝・け
*   **谺｡蟷ｴ蠎ｦ縺ｸ縺ｮ螳溽ｸｾ蜿肴丐**: 莉雁ｹｴ蠎ｦ縺ｮ縲悟ｮ溽ｸｾ縲阪ョ繝ｼ繧ｿ縺後∵ｬ｡蟷ｴ蠎ｦ縺ｮ縲悟燕蟷ｴ蠎ｦ螳溽ｸｾ縲阪→縺励※閾ｪ蜍慕噪縺ｫ蜿ら・縺輔ｌ繧九Ο繧ｸ繝・け繧呈､懆ｨｼ繝ｻ遒ｺ遶九＠縺ｾ縺励◆縲ゅ％繧後↓繧医ｊ縲∝ｹｴ縺悟､峨ｏ縺｣縺滄圀縺ｮ繝・・繧ｿ遘ｻ陦後・謇矩俣繧貞炎貂帙＠縺ｾ縺励◆縲・

### 7.3. 縺昴・莉匁隼蝟・
*   **陦ｨ遉ｺ鬆・ｺ上・譛驕ｩ蛹・*: 驛ｨ髢縺ｮ陦ｨ遉ｺ鬆・ｒ讌ｭ蜍吝ｮ滓・縺ｫ蜷医ｏ縺帙※縲碁｣溘・繝悶Λ繝ｳ繝蛾､ｨ -> 蠎苓・ -> Web -> 蜊ｸ縲阪↓螟画峩縺励∪縺励◆縲・
*   **Excel繝・・繧ｿ謨ｴ蜷域ｧ**: 驛ｨ髢蜷咲ｧｰ繧・岼讓吝､繧偵∫ｵ檎炊繝ｻ邨悟霧邂｡逅・〒菴ｿ逕ｨ縺輔ｌ縺ｦ縺・ｋExcel繧ｷ繝ｼ繝医・螳夂ｾｩ縺ｫ螳悟・貅匁侠縺輔○縺ｾ縺励◆縲・

## 8. 繝ｬ繧ｷ繝泌次萓｡險育ｮ励・繝・・繧ｿ繝吶・繧ｹ讖溯・縺ｮ蠑ｷ蛹厄ｼ・026/02/17霑ｽ蜉・・

### 8.1. 繝ｬ繧ｷ繝秘㍾驥剰ｨ育ｮ励・邊ｾ邱ｻ蛹・
*   **蜈ｨ菴馴㍾驥上・邂怜・**: 譚先侭・亥次譚先侭・峨→荳ｭ髢灘刈蟾･蜩√・蜷郁ｨ磯㍾驥上ｒ閾ｪ蜍戊ｨ育ｮ励＠縲∬ｩｳ邏ｰ逕ｻ髱｢縺翫ｈ縺ｳ蜊ｰ蛻ｷ逕ｨPDF縺ｫ陦ｨ遉ｺ縺吶ｋ繧医≧縺ｫ縺励∪縺励◆縲・
*   **荳ｭ髢灘刈蟾･蜩√・蜊倅ｽ榊､画峩**: 繝ｬ繧ｷ繝泌・縺ｧ縺ｮ荳ｭ髢馴Κ蜩√・謇ｱ縺・ｒ縲携縲阪°繧峨悟九阪↓螟画峩縺励∪縺励◆縲ゅ％繧後↓繧医ｊ縲・蛟九≠縺溘ｊ縺ｮ驥埼㍼繧剃ｿ晄戟縺励◆縺ｾ縺ｾ繝ｬ繧ｷ繝疲ｧ区・縺悟庄閭ｽ縺ｫ縺ｪ繧翫∪縺励◆縲・

### 8.2. 譚先侭繝・・繧ｿ繝吶・繧ｹ縺ｮ繝槭せ繧ｿ繝ｼ邂｡逅・
*   **隲ｸ邨瑚ｲｻ・・xpenses・峨・DB蛹・*: 繝､繝槭ヨ騾∵侭縲∽ｺｺ莉ｶ雋ｻ縲、mazon謇区焚譁吶↑縺ｩ縺ｮ隲ｸ邨瑚ｲｻ繧偵ョ繝ｼ繧ｿ繝吶・繧ｹ・・expenses`繝・・繝悶Ν・峨〒荳諡ｬ邂｡逅・〒縺阪ｋ繧医≧縺ｫ縺励∪縺励◆縲・
*   **Amazon謇区焚譁咏紫縺ｮ蜍慕噪險育ｮ・*: 逕ｻ髱｢荳翫〒謇区焚譁咏紫・・・峨ｒ閾ｪ逕ｱ縺ｫ險ｭ螳壼庄閭ｽ縺ｫ縺励∬ｲｩ螢ｲ萓｡譬ｼ縺ｮ螟画峩縺ｫ蜷医ｏ縺帙※繝ｪ繧｢繝ｫ繧ｿ繧､繝縺ｧ謇区焚譁呻ｼ亥次萓｡・峨′譖ｴ譁ｰ縺輔ｌ繧九Ο繧ｸ繝・け繧貞ｮ溯｣・＠縺ｾ縺励◆縲・
*   **遞手ｾｼ繝ｻ遞取栢險ｭ螳壹・豌ｸ邯壼喧**: 蜷・攝譁吶＃縺ｨ縺ｫ遞手ｾｼ縺狗ｨ取栢縺九ｒ菫晏ｭ倥☆繧九◆繧√・繧ｫ繝ｩ繝繧奪B縺ｫ霑ｽ蜉縺励∬｡ｨ遉ｺ縺ｨ險育ｮ励↓蜿肴丐縺輔○縺ｾ縺励◆縲・

---
*菴懈・譌･: 2026/02/02 / 譛邨よ峩譁ｰ譌･: 2026/02/17*

### 8.3. 諸経費データの整理統合（2026/02/17）
*   **資材からの分離**: 名称ベース（送料、人件費等）で23件のアイテムを抽出し、materialsテーブルからexpensesテーブルへ移行。
*   **レシピ紐付けの自動変換**: 全レシピの構成要素を精査し、資材として登録されていた諸経費をシステム上の「諸経費（Expense）」属性へ一括変換。これにより印刷レイアウトや重量計算の正確性が向上。

### 9. 見積書AI解析機能（2026/02/17）
*   **Gemini 1.5 Flash連携**: 画像PDFから直接商品名と単価を抽出し、DBとのファジーマッチング（名称のゆらぎ吸収）を実現。
*   **更新確認UI**: AIが提示した「更新」「新規」「無視」の提案をユーザーがレビューし、一括または個別に反映できるワークフローを構築。
*   **低品質OCR対応**: FAX等のノイズが多い画像に対しても、DB名リストをコンテキストとして渡すことで高い精度での復元照合が可能。
